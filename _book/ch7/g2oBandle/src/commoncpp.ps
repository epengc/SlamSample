%!PS-Adobe-3.0
%%Title: common.cpp
%%For: epengc
%%Creator: VIM - Vi IMproved 8.1 (2018 May 18)
%%CreationDate: Tue Dec 21 23:31:25 2021
%%DocumentData: Clean8Bit
%%Orientation: Portrait
%%Pages: (atend)
%%PageOrder: Ascend
%%BoundingBox: 18 42 528 752
%%DocumentMedia: letter 612 792 0 () ()
%%DocumentNeededResources: font Courier
%%+ font Courier-Bold
%%+ font Courier-Oblique
%%+ font Courier-BoldOblique
%%DocumentSuppliedResources: procset VIM-Prolog 1.4 1
%%+ encoding VIM-latin1 1.0 0
%%Requirements: duplex collate color
%%EndComments
%%BeginDefaults
%%PageResources: font Courier
%%+ font Courier-Bold
%%+ font Courier-Oblique
%%+ font Courier-BoldOblique
%%PageMedia: letter
%%EndDefaults
%%BeginProlog
%%BeginResource: procset VIM-Prolog
%%BeginDocument: /usr/share/vim/vim81/print/prolog.ps
%!PS-Adobe-3.0 Resource-ProcSet
%%Title: VIM-Prolog
%%Version: 1.4 1
%%EndComments
% Editing of this file is NOT RECOMMENDED.  You run a very good risk of causing
% all PostScript printing from VIM failing if you do.  PostScript is not called
% a write-only language for nothing!
/packedarray where not{userdict begin/setpacking/pop load def/currentpacking
false def end}{pop}ifelse/CP currentpacking def true setpacking
/bd{bind def}bind def/ld{load def}bd/ed{exch def}bd/d/def ld
/db{dict begin}bd/cde{currentdict end}bd
/T true d/F false d
/SO null d/sv{/SO save d}bd/re{SO restore}bd
/L2 systemdict/languagelevel 2 copy known{get exec}{pop pop 1}ifelse 2 ge d
/m/moveto ld/s/show ld /ms{m s}bd /g/setgray ld/r/setrgbcolor ld/sp{showpage}bd
/gs/gsave ld/gr/grestore ld/cp/currentpoint ld
/ul{gs UW setlinewidth cp UO add 2 copy newpath m 3 1 roll add exch lineto
stroke gr}bd
/bg{gs r cp BO add 4 -2 roll rectfill gr}bd
/sl{90 rotate 0 exch translate}bd
L2{
/sspd{mark exch{setpagedevice}stopped cleartomark}bd
/nc{1 db/NumCopies ed cde sspd}bd
/sps{3 db/Orientation ed[3 1 roll]/PageSize ed/ImagingBBox null d cde sspd}bd
/dt{2 db/Tumble ed/Duplex ed cde sspd}bd
/c{1 db/Collate ed cde sspd}bd
}{
/nc{/#copies ed}bd
/sps{statusdict/setpage get exec}bd
/dt{statusdict/settumble 2 copy known{get exec}{pop pop pop}ifelse
statusdict/setduplexmode 2 copy known{get exec}{pop pop pop}ifelse}bd
/c{pop}bd
}ifelse
/ffs{findfont exch scalefont d}bd/sf{setfont}bd
/ref{1 db findfont dup maxlength dict/NFD ed{exch dup/FID ne{exch NFD 3 1 roll
put}{pop pop}ifelse}forall/Encoding findresource dup length 256 eq{NFD/Encoding
3 -1 roll put}{pop}ifelse NFD dup/FontType get 3 ne{/CharStrings}{/CharProcs}
ifelse 2 copy known{2 copy get dup maxlength dict copy[/questiondown/space]{2
copy known{2 copy get 2 index/.notdef 3 -1 roll put pop exit}if pop}forall put
}{pop pop}ifelse dup NFD/FontName 3 -1 roll put NFD definefont pop end}bd
CP setpacking
(\004)cvn{}bd
% vim:ff=unix:
%%EOF
%%EndDocument
%%EndResource
%%BeginResource: encoding VIM-latin1
%%BeginDocument: /usr/share/vim/vim81/print/latin1.ps
%!PS-Adobe-3.0 Resource-Encoding
%%Title: VIM-latin1
%%Version: 1.0 0
%%EndComments
/VIM-latin1[
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/space /exclam /quotedbl /numbersign /dollar /percent /ampersand /quotesingle
/parenleft /parenright /asterisk /plus /comma /minus /period /slash
/zero /one /two /three /four /five /six /seven
/eight /nine /colon /semicolon /less /equal /greater /question
/at /A /B /C /D /E /F /G
/H /I /J /K /L /M /N /O
/P /Q /R /S /T /U /V /W
/X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
/grave /a /b /c /d /e /f /g
/h /i /j /k /l /m /n /o
/p /q /r /s /t /u /v /w
/x /y /z /braceleft /bar /braceright /asciitilde /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
/space /exclamdown /cent /sterling /currency /yen /brokenbar /section
/dieresis /copyright /ordfeminine /guillemotleft /logicalnot /hyphen /registered /macron
/degree /plusminus /twosuperior /threesuperior /acute /mu /paragraph /periodcentered
/cedilla /onesuperior /ordmasculine /guillemotright /onequarter /onehalf /threequarters /questiondown
/Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
/Egrave /Eacute /Ecircumflex /Edieresis /Igrave /Iacute /Icircumflex /Idieresis
/Eth /Ntilde /Ograve /Oacute /Ocircumflex /Otilde /Odieresis /multiply
/Oslash /Ugrave /Uacute /Ucircumflex /Udieresis /Yacute /Thorn /germandbls
/agrave /aacute /acircumflex /atilde /adieresis /aring /ae /ccedilla
/egrave /eacute /ecircumflex /edieresis /igrave /iacute /icircumflex /idieresis
/eth /ntilde /ograve /oacute /ocircumflex /otilde /odieresis /divide
/oslash /ugrave /uacute /ucircumflex /udieresis /yacute /thorn /ydieresis]
/Encoding defineresource pop
% vim:ff=unix:
%%EOF
%%EndDocument
%%EndResource
%%EndProlog
%%BeginSetup
612 792 0 sps
1 nc
T F dt
T c
%%IncludeResource: font Courier
/_F0 /VIM-latin1 /Courier ref
/F0 10 /_F0 ffs
%%IncludeResource: font Courier-Bold
/_F1 /VIM-latin1 /Courier-Bold ref
/F1 10 /_F1 ffs
%%IncludeResource: font Courier-Oblique
/_F2 /VIM-latin1 /Courier-Oblique ref
/F2 10 /_F2 ffs
%%IncludeResource: font Courier-BoldOblique
/_F3 /VIM-latin1 /Courier-BoldOblique ref
/F3 10 /_F3 ffs
/UO -1 d
/UW 0.5 d
/BO -2.5 d
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
sv
0 g
F0 sf
%%EndPageSetup
F1 sf
(common.cpp                                                                             Page 1)18.36 744.9 ms
F0 sf
0.498 0.498 0 r
(     1)18.36 724.9 ms
0.376 g
(#include )66.36 724.9 ms
0 0.251 0 r
(<cstdio>)s
0.498 0.498 0 r
(     2)18.36 714.9 ms
0.376 g
(#include )66.36 714.9 ms
0 0.251 0 r
(<fstream>)s
0.498 0.498 0 r
(     3)18.36 704.9 ms
0.376 g
(#include )66.36 704.9 ms
0 0.251 0 r
(<iostream>)s
0.498 0.498 0 r
(     4)18.36 694.9 ms
0.376 g
(#include )66.36 694.9 ms
0 0.251 0 r
(<string>)s
0.498 0.498 0 r
(     5)18.36 684.9 ms
0.376 g
(#include )66.36 684.9 ms
0 0.251 0 r
(<vector>)s
0.498 0.498 0 r
(     6)18.36 674.9 ms
0.376 g
(#include )66.36 674.9 ms
0 0.251 0 r
(<Eigen/Core>)s
0.498 0.498 0 r
(     7)18.36 664.9 ms
0.376 g
(#include )66.36 664.9 ms
0 0.251 0 r
(<Eigen/Dense>)s
0.498 0.498 0 r
(     8)18.36 654.9 ms
(     9)18.36 644.9 ms
0.376 g
(#include )66.36 644.9 ms
0 0.251 0 r
("common.h")s
0.498 0.498 0 r
(    10)18.36 634.9 ms
0.376 g
(#include )66.36 634.9 ms
0 0.251 0 r
("rotation.h")s
0.498 0.498 0 r
(    11)18.36 624.9 ms
0.376 g
(#include )66.36 624.9 ms
0 0.251 0 r
("random.h")s
0.498 0.498 0 r
(    12)18.36 614.9 ms
(    13)18.36 604.9 ms
0.376 0 0 r
(typedef)66.36 604.9 ms
0 g
( Eigen::Map<Eigen::VectorXd> VectorRef;)s
0.498 0.498 0 r
(    14)18.36 594.9 ms
0.376 0 0 r
(typedef)66.36 594.9 ms
0 g
( Eigen::Map<)s
0.376 0 0 r
(const)s
0 g
( Eigen::VectorXd> ConstVectorRef;)s
0.498 0.498 0 r
(    15)18.36 584.9 ms
(    16)18.36 574.9 ms
0.376 0 0 r
(template)66.36 574.9 ms
0 g
(<)s
0.376 0 0 r
(typename)s
0 g
( T>)s
0.498 0.498 0 r
(    17)18.36 564.9 ms
0.376 0 0 r
(void)66.36 564.9 ms
0 g
( )s
0.376 g
(FscanfOrDie)s
0 g
(\()s
0.376 0 0 r
(FILE)s
0 g
( *fptr, )s
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(char)s
0 g
( *format, T *value\) {)s
0.498 0.498 0 r
(    18)18.36 554.9 ms
0 g
(    )66.36 554.9 ms
0.376 0 0 r
(int)s
0 g
( num_scanned = )s
0.376 g
(fscanf)s
0 g
(\(fptr, format, value\);)s
0.498 0.498 0 r
(    19)18.36 544.9 ms
0 g
(    )66.36 544.9 ms
0 0.498 0 r
(if)s
0 g
( \(num_scanned != )s
0.498 0.125 0.498 r
(1)s
0 g
(\))s
0.498 0.498 0 r
(    20)18.36 534.9 ms
0 g
(        )66.36 534.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.251 0.251 0 r
(cerr)s
0 g
( << )s
0 0.251 0 r
("Invalid UW data file. ")s
0 g
(;)s
0.498 0.498 0 r
(    21)18.36 524.9 ms
0 g
(})66.36 524.9 ms
0.498 0.498 0 r
(    22)18.36 514.9 ms
(    23)18.36 504.9 ms
0.376 0 0 r
(void)66.36 504.9 ms
0 g
( )s
0.376 g
(PerturbPoint3)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( sigma, )s
0.376 0 0 r
(double)s
0 g
( *point\) {)s
0.498 0.498 0 r
(    24)18.36 494.9 ms
0 g
(    )66.36 494.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.498 0.125 0.498 r
(3)s
0 g
(; ++i\))s
0.498 0.498 0 r
(    25)18.36 484.9 ms
0 g
(        point[i] += )66.36 484.9 ms
0.376 g
(RandNormal)s
0 g
(\(\) * sigma;)s
0.498 0.498 0 r
(    26)18.36 474.9 ms
0 g
(})66.36 474.9 ms
0.498 0.498 0 r
(    27)18.36 464.9 ms
(    28)18.36 454.9 ms
0.376 0 0 r
(double)66.36 454.9 ms
0 g
( )s
0.376 g
(Median)s
0 g
(\()s
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(vector)s
0 g
(<)s
0.376 0 0 r
(double)s
0 g
(> *data\) {)s
0.498 0.498 0 r
(    29)18.36 444.9 ms
0 g
(    )66.36 444.9 ms
0.376 0 0 r
(int)s
0 g
( n = data->)s
0.376 g
(size)s
0 g
(\(\);)s
0.498 0.498 0 r
(    30)18.36 434.9 ms
0 g
(    )66.36 434.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(vector)s
0 g
(<)s
0.376 0 0 r
(double)s
0 g
(>::)s
0.376 0 0 r
(iterator)s
0 g
( mid_point = data->)s
0.376 g
(begin)s
0 g
(\(\) + n / )s
0.498 0.125 0.498 r
(2)s
0 g
(;)s
0.498 0.498 0 r
(    31)18.36 424.9 ms
0 g
(    )66.36 424.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 g
(nth_element)s
0 g
(\(data->)s
0.376 g
(begin)s
0 g
(\(\), mid_point, data->)s
0.376 g
(end)s
0 g
(\(\)\);)s
0.498 0.498 0 r
(    32)18.36 414.9 ms
0 g
(    )66.36 414.9 ms
0 0.498 0 r
(return)s
0 g
( *mid_point;)s
0.498 0.498 0 r
(    33)18.36 404.9 ms
0 g
(})66.36 404.9 ms
0.498 0.498 0 r
(    34)18.36 394.9 ms
(    35)18.36 384.9 ms
0 g
(BALProblem::)66.36 384.9 ms
0.376 g
(BALProblem)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(string)s
0 g
( &filename, )s
0.376 0 0 r
(bool)s
0 g
( use_quaternions\) {)s
0.498 0.498 0 r
(    36)18.36 374.9 ms
0 g
(    )66.36 374.9 ms
0.376 0 0 r
(FILE)s
0 g
( *fptr = )s
0.376 g
(fopen)s
0 g
(\(filename.)s
0.376 g
(c_str)s
0 g
(\(\), )s
0 0.251 0 r
("r")s
0 g
(\);)s
0.498 0.498 0 r
(    37)18.36 364.9 ms
(    38)18.36 354.9 ms
0 g
(    )66.36 354.9 ms
0 0.498 0 r
(if)s
0 g
( \(fptr == )s
0.251 0.251 0 r
(NULL)s
0 g
(\) {)s
0.498 0.498 0 r
(    39)18.36 344.9 ms
0 g
(        )66.36 344.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.251 0.251 0 r
(cerr)s
0 g
( << )s
0 0.251 0 r
("Error: unable to open file ")s
0 g
( << filename;)s
0.498 0.498 0 r
(    40)18.36 334.9 ms
0 g
(        )66.36 334.9 ms
0 0.498 0 r
(return)s
0 g
(;)s
0.498 0.498 0 r
(    41)18.36 324.9 ms
0 g
(    };)66.36 324.9 ms
0.498 0.498 0 r
(    42)18.36 314.9 ms
(    43)18.36 304.9 ms
0 g
(    )66.36 304.9 ms
0 0.498 0.498 r
(// This wil die horribly on invalid files. Them's the breaks.)s
0.498 0.498 0 r
(    44)18.36 294.9 ms
0 g
(    )66.36 294.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
(")s
0 g
(, &num_cameras_\);)s
0.498 0.498 0 r
(    45)18.36 284.9 ms
0 g
(    )66.36 284.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
(")s
0 g
(, &num_points_\);)s
0.498 0.498 0 r
(    46)18.36 274.9 ms
0 g
(    )66.36 274.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
(")s
0 g
(, &num_observations_\);)s
0.498 0.498 0 r
(    47)18.36 264.9 ms
(    48)18.36 254.9 ms
0 g
(    )66.36 254.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.251 0.251 0 r
(cout)s
0 g
( << )s
0 0.251 0 r
("Header: ")s
0 g
( << num_cameras_)s
0.498 0.498 0 r
(    49)18.36 244.9 ms
0 g
(              << )66.36 244.9 ms
0 0.251 0 r
(" ")s
0 g
( << num_points_)s
0.498 0.498 0 r
(    50)18.36 234.9 ms
0 g
(              << )66.36 234.9 ms
0 0.251 0 r
(" ")s
0 g
( << num_observations_;)s
0.498 0.498 0 r
(    51)18.36 224.9 ms
(    52)18.36 214.9 ms
0 g
(    point_index_ = )66.36 214.9 ms
0 0.498 0 r
(new)s
0 g
( )s
0.376 0 0 r
(int)s
0 g
([num_observations_];)s
0.498 0.498 0 r
(    53)18.36 204.9 ms
0 g
(    camera_index_ = )66.36 204.9 ms
0 0.498 0 r
(new)s
0 g
( )s
0.376 0 0 r
(int)s
0 g
([num_observations_];)s
0.498 0.498 0 r
(    54)18.36 194.9 ms
0 g
(    observations_ = )66.36 194.9 ms
0 0.498 0 r
(new)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
([)s
0.498 0.125 0.498 r
(2)s
0 g
( * num_observations_];)s
0.498 0.498 0 r
(    55)18.36 184.9 ms
(    56)18.36 174.9 ms
0 g
(    num_parameters_ = )66.36 174.9 ms
0.498 0.125 0.498 r
(9)s
0 g
( * num_cameras_ + )s
0.498 0.125 0.498 r
(3)s
0 g
( * num_points_;)s
0.498 0.498 0 r
(    57)18.36 164.9 ms
0 g
(    parameters_ = )66.36 164.9 ms
0 0.498 0 r
(new)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
([num_parameters_];)s
0.498 0.498 0 r
(    58)18.36 154.9 ms
(    59)18.36 144.9 ms
0 g
(    )66.36 144.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_observations_; ++i\) {)s
0.498 0.498 0 r
(    60)18.36 134.9 ms
0 g
(        )66.36 134.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
(")s
0 g
(, camera_index_ + i\);)s
0.498 0.498 0 r
(    61)18.36 124.9 ms
0 g
(        )66.36 124.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
(")s
0 g
(, point_index_ + i\);)s
0.498 0.498 0 r
(    62)18.36 114.9 ms
0 g
(        )66.36 114.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(0)s
0 g
(; j < )s
0.498 0.125 0.498 r
(2)s
0 g
(; ++j\) {)s
0.498 0.498 0 r
(    63)18.36 104.9 ms
0 g
(            )66.36 104.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%lf)s
0 0.251 0 r
(")s
0 g
(, observations_ + )s
0.498 0.125 0.498 r
(2)s
0 g
( * i + j\);)s
0.498 0.498 0 r
(    64)18.36 94.9 ms
0 g
(        })66.36 94.9 ms
0.498 0.498 0 r
(    65)18.36 84.9 ms
0 g
(    })66.36 84.9 ms
0.498 0.498 0 r
(    66)18.36 74.9 ms
(    67)18.36 64.9 ms
0 g
(    )66.36 64.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_parameters_; ++i\) {)s
0.498 0.498 0 r
(    68)18.36 54.9 ms
0 g
(        )66.36 54.9 ms
0.376 g
(FscanfOrDie)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%lf)s
0 0.251 0 r
(")s
0 g
(, parameters_ + i\);)s
0.498 0.498 0 r
(    69)18.36 44.9 ms
0 g
(    })66.36 44.9 ms
re sp
%%PageTrailer
%%Page: 2 2
%%BeginPageSetup
sv
0 g
F0 sf
%%EndPageSetup
F1 sf
(common.cpp                                                                             Page 2)18.36 744.9 ms
F0 sf
0.498 0.498 0 r
(    70)18.36 724.9 ms
(    71)18.36 714.9 ms
0 g
(    )66.36 714.9 ms
0.376 g
(fclose)s
0 g
(\(fptr\);)s
0.498 0.498 0 r
(    72)18.36 704.9 ms
(    73)18.36 694.9 ms
0 g
(    use_quaternions_ = use_quaternions;)66.36 694.9 ms
0.498 0.498 0 r
(    74)18.36 684.9 ms
0 g
(    )66.36 684.9 ms
0 0.498 0 r
(if)s
0 g
( \(use_quaternions\) {)s
0.498 0.498 0 r
(    75)18.36 674.9 ms
0 g
(        )66.36 674.9 ms
0 0.498 0.498 r
(// Switch the angle-axis rotations to quaternions.)s
0.498 0.498 0 r
(    76)18.36 664.9 ms
0 g
(        num_parameters_ = )66.36 664.9 ms
0.498 0.125 0.498 r
(10)s
0 g
( * num_cameras_ + )s
0.498 0.125 0.498 r
(3)s
0 g
( * num_points_;)s
0.498 0.498 0 r
(    77)18.36 654.9 ms
0 g
(        )66.36 654.9 ms
0.376 0 0 r
(double)s
0 g
( *quaternion_parameters = )s
0 0.498 0 r
(new)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
([num_parameters_];)s
0.498 0.498 0 r
(    78)18.36 644.9 ms
0 g
(        )66.36 644.9 ms
0.376 0 0 r
(double)s
0 g
( *original_cursor = parameters_;)s
0.498 0.498 0 r
(    79)18.36 634.9 ms
0 g
(        )66.36 634.9 ms
0.376 0 0 r
(double)s
0 g
( *quaternion_cursor = quaternion_parameters;)s
0.498 0.498 0 r
(    80)18.36 624.9 ms
0 g
(        )66.36 624.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_cameras_; ++i\) {)s
0.498 0.498 0 r
(    81)18.36 614.9 ms
0 g
(            )66.36 614.9 ms
0.376 g
(AngleAxisToQuaternion)s
0 g
(\(original_cursor, quaternion_cursor\);)s
0.498 0.498 0 r
(    82)18.36 604.9 ms
0 g
(            quaternion_cursor += )66.36 604.9 ms
0.498 0.125 0.498 r
(4)s
0 g
(;)s
0.498 0.498 0 r
(    83)18.36 594.9 ms
0 g
(            original_cursor += )66.36 594.9 ms
0.498 0.125 0.498 r
(3)s
0 g
(;)s
0.498 0.498 0 r
(    84)18.36 584.9 ms
0 g
(            )66.36 584.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(4)s
0 g
(; j < )s
0.498 0.125 0.498 r
(10)s
0 g
(; ++j\) {)s
0.498 0.498 0 r
(    85)18.36 574.9 ms
0 g
(                *quaternion_cursor++ = *original_cursor++;)66.36 574.9 ms
0.498 0.498 0 r
(    86)18.36 564.9 ms
0 g
(            })66.36 564.9 ms
0.498 0.498 0 r
(    87)18.36 554.9 ms
0 g
(        })66.36 554.9 ms
0.498 0.498 0 r
(    88)18.36 544.9 ms
0 g
(        )66.36 544.9 ms
0 0.498 0.498 r
(// Copy the rest of the points.)s
0.498 0.498 0 r
(    89)18.36 534.9 ms
0 g
(        )66.36 534.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.498 0.125 0.498 r
(3)s
0 g
( * num_points_; ++i\) {)s
0.498 0.498 0 r
(    90)18.36 524.9 ms
0 g
(            *quaternion_cursor++ = *original_cursor++;)66.36 524.9 ms
0.498 0.498 0 r
(    91)18.36 514.9 ms
0 g
(        })66.36 514.9 ms
0.498 0.498 0 r
(    92)18.36 504.9 ms
0 g
(        )66.36 504.9 ms
0 0.498 0.498 r
(// Swap in the quaternion parameters.)s
0.498 0.498 0 r
(    93)18.36 494.9 ms
0 g
(        )66.36 494.9 ms
0 0.498 0 r
(delete)s
0 g
([]parameters_;)s
0.498 0.498 0 r
(    94)18.36 484.9 ms
0 g
(        parameters_ = quaternion_parameters;)66.36 484.9 ms
0.498 0.498 0 r
(    95)18.36 474.9 ms
0 g
(    })66.36 474.9 ms
0.498 0.498 0 r
(    96)18.36 464.9 ms
0 g
(})66.36 464.9 ms
0.498 0.498 0 r
(    97)18.36 454.9 ms
(    98)18.36 444.9 ms
0.376 0 0 r
(void)66.36 444.9 ms
0 g
( BALProblem::)s
0.376 g
(WriteToFile)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(string)s
0 g
( &filename\) )s
0.376 0 0 r
(const)s
0 g
( {)s
0.498 0.498 0 r
(    99)18.36 434.9 ms
0 g
(    )66.36 434.9 ms
0.376 0 0 r
(FILE)s
0 g
( *fptr = )s
0.376 g
(fopen)s
0 g
(\(filename.)s
0.376 g
(c_str)s
0 g
(\(\), )s
0 0.251 0 r
("w")s
0 g
(\);)s
0.498 0.498 0 r
(   100)18.36 424.9 ms
(   101)18.36 414.9 ms
0 g
(    )66.36 414.9 ms
0 0.498 0 r
(if)s
0 g
( \(fptr == )s
0.251 0.251 0 r
(NULL)s
0 g
(\) {)s
0.498 0.498 0 r
(   102)18.36 404.9 ms
0 g
(        )66.36 404.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.251 0.251 0 r
(cerr)s
0 g
( << )s
0 0.251 0 r
("Error: unable to open file ")s
0 g
( << filename;)s
0.498 0.498 0 r
(   103)18.36 394.9 ms
0 g
(        )66.36 394.9 ms
0 0.498 0 r
(return)s
0 g
(;)s
0.498 0.498 0 r
(   104)18.36 384.9 ms
0 g
(    })66.36 384.9 ms
0.498 0.498 0 r
(   105)18.36 374.9 ms
(   106)18.36 364.9 ms
0 g
(    )66.36 364.9 ms
0.376 g
(fprintf)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
( )s
0 g
(%d)s
0 0.251 0 r
( )s
0 g
(%d)s
0 0.251 0 r
( )s
0 g
(%d\\n)s
0 0.251 0 r
(")s
0 g
(, num_cameras_, num_cameras_, num_points_, num_obser)s
(vations_\);)66.36 354.9 ms
0.498 0.498 0 r
(   107)18.36 344.9 ms
(   108)18.36 334.9 ms
0 g
(    )66.36 334.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_observations_; ++i\) {)s
0.498 0.498 0 r
(   109)18.36 324.9 ms
0 g
(        )66.36 324.9 ms
0.376 g
(fprintf)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%d)s
0 0.251 0 r
( )s
0 g
(%d)s
0 0.251 0 r
(")s
0 g
(, camera_index_[i], point_index_[i]\);)s
0.498 0.498 0 r
(   110)18.36 314.9 ms
0 g
(        )66.36 314.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(0)s
0 g
(; j < )s
0.498 0.125 0.498 r
(2)s
0 g
(; ++j\) {)s
0.498 0.498 0 r
(   111)18.36 304.9 ms
0 g
(            )66.36 304.9 ms
0.376 g
(fprintf)s
0 g
(\(fptr, )s
0 0.251 0 r
(" )s
0 g
(%g)s
0 0.251 0 r
(")s
0 g
(, observations_[)s
0.498 0.125 0.498 r
(2)s
0 g
( * i + j]\);)s
0.498 0.498 0 r
(   112)18.36 294.9 ms
0 g
(        })66.36 294.9 ms
0.498 0.498 0 r
(   113)18.36 284.9 ms
0 g
(        )66.36 284.9 ms
0.376 g
(fprintf)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(\\n)s
0 0.251 0 r
(")s
0 g
(\);)s
0.498 0.498 0 r
(   114)18.36 274.9 ms
0 g
(    })66.36 274.9 ms
0.498 0.498 0 r
(   115)18.36 264.9 ms
(   116)18.36 254.9 ms
0 g
(    )66.36 254.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.376 g
(num_cameras)s
0 g
(\(\); ++i\) {)s
0.498 0.498 0 r
(   117)18.36 244.9 ms
0 g
(        )66.36 244.9 ms
0.376 0 0 r
(double)s
0 g
( angleaxis[)s
0.498 0.125 0.498 r
(9)s
0 g
(];)s
0.498 0.498 0 r
(   118)18.36 234.9 ms
0 g
(        )66.36 234.9 ms
0 0.498 0 r
(if)s
0 g
( \(use_quaternions_\) {)s
0.498 0.498 0 r
(   119)18.36 224.9 ms
0 g
(            )66.36 224.9 ms
0 0.498 0.498 r
(//OutPut in angle-axis format.)s
0.498 0.498 0 r
(   120)18.36 214.9 ms
0 g
(            )66.36 214.9 ms
0.376 g
(QuaternionToAngleAxis)s
0 g
(\(parameters_ + )s
0.498 0.125 0.498 r
(10)s
0 g
( * i, angleaxis\);)s
0.498 0.498 0 r
(   121)18.36 204.9 ms
0 g
(            )66.36 204.9 ms
0.376 g
(memcpy)s
0 g
(\(angleaxis + )s
0.498 0.125 0.498 r
(3)s
0 g
(, parameters_ + )s
0.498 0.125 0.498 r
(10)s
0 g
( * i + )s
0.498 0.125 0.498 r
(4)s
0 g
(, )s
0.498 0.125 0.498 r
(6)s
0 g
( * )s
0 0.498 0 r
(sizeof)s
0 g
(\()s
0.376 0 0 r
(double)s
0 g
(\)\);)s
0.498 0.498 0 r
(   122)18.36 194.9 ms
0 g
(        } )66.36 194.9 ms
0 0.498 0 r
(else)s
0 g
( {)s
0.498 0.498 0 r
(   123)18.36 184.9 ms
0 g
(            )66.36 184.9 ms
0.376 g
(memcpy)s
0 g
(\(angleaxis, parameters_ + )s
0.498 0.125 0.498 r
(9)s
0 g
( * i, )s
0.498 0.125 0.498 r
(9)s
0 g
( * )s
0 0.498 0 r
(sizeof)s
0 g
(\()s
0.376 0 0 r
(double)s
0 g
(\)\);)s
0.498 0.498 0 r
(   124)18.36 174.9 ms
0 g
(        })66.36 174.9 ms
0.498 0.498 0 r
(   125)18.36 164.9 ms
0 g
(        )66.36 164.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(0)s
0 g
(; j < )s
0.498 0.125 0.498 r
(9)s
0 g
(; ++j\) {)s
0.498 0.498 0 r
(   126)18.36 154.9 ms
0 g
(            )66.36 154.9 ms
0.376 g
(fprintf)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%.16g\\n)s
0 0.251 0 r
(")s
0 g
(, angleaxis[j]\);)s
0.498 0.498 0 r
(   127)18.36 144.9 ms
0 g
(        })66.36 144.9 ms
0.498 0.498 0 r
(   128)18.36 134.9 ms
0 g
(    })66.36 134.9 ms
0.498 0.498 0 r
(   129)18.36 124.9 ms
(   130)18.36 114.9 ms
0 g
(    )66.36 114.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *points = parameters_ + )s
0.376 g
(camera_block_size)s
0 g
(\(\) * num_cameras_;)s
0.498 0.498 0 r
(   131)18.36 104.9 ms
0 g
(    )66.36 104.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.376 g
(num_points)s
0 g
(\(\); ++i\) {)s
0.498 0.498 0 r
(   132)18.36 94.9 ms
0 g
(        )66.36 94.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *point = points + i * )s
0.376 g
(point_block_size)s
0 g
(\(\);)s
0.498 0.498 0 r
(   133)18.36 84.9 ms
0 g
(        )66.36 84.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(0)s
0 g
(; j < )s
0.376 g
(point_block_size)s
0 g
(\(\); ++j\) {)s
0.498 0.498 0 r
(   134)18.36 74.9 ms
0 g
(            )66.36 74.9 ms
0.376 g
(fprintf)s
0 g
(\(fptr, )s
0 0.251 0 r
(")s
0 g
(%.16g\\n)s
0 0.251 0 r
(")s
0 g
(, point[j]\);)s
0.498 0.498 0 r
(   135)18.36 64.9 ms
0 g
(        })66.36 64.9 ms
0.498 0.498 0 r
(   136)18.36 54.9 ms
0 g
(    })66.36 54.9 ms
0.498 0.498 0 r
(   137)18.36 44.9 ms
re sp
%%PageTrailer
%%Page: 3 3
%%BeginPageSetup
sv
0 g
F0 sf
%%EndPageSetup
F1 sf
(common.cpp                                                                             Page 3)18.36 744.9 ms
F0 sf
0.498 0.498 0 r
(   138)18.36 724.9 ms
0 g
(    )66.36 724.9 ms
0.376 g
(fclose)s
0 g
(\(fptr\);)s
0.498 0.498 0 r
(   139)18.36 714.9 ms
0 g
(})66.36 714.9 ms
0.498 0.498 0 r
(   140)18.36 704.9 ms
(   141)18.36 694.9 ms
0 0.498 0.498 r
(// Write the problem to a PLY file for inspection in Meshlab or CloudCompare)66.36 694.9 ms
0.498 0.498 0 r
(   142)18.36 684.9 ms
0.376 0 0 r
(void)66.36 684.9 ms
0 g
( BALProblem::)s
0.376 g
(WriteToPLYFile)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(string)s
0 g
( &filename\) )s
0.376 0 0 r
(const)s
0 g
( {)s
0.498 0.498 0 r
(   143)18.36 674.9 ms
0 g
(    )66.36 674.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(ofstream)s
0 g
( )s
0.376 g
(of)s
0 g
(\(filename.)s
0.376 g
(c_str)s
0 g
(\(\)\);)s
0.498 0.498 0 r
(   144)18.36 664.9 ms
(   145)18.36 654.9 ms
0 g
(    of << )66.36 654.9 ms
0 0.251 0 r
("ply")s
0.498 0.498 0 r
(   146)18.36 644.9 ms
0 g
(       << '\\n' << )66.36 644.9 ms
0 0.251 0 r
("format ascii 1.0")s
0.498 0.498 0 r
(   147)18.36 634.9 ms
0 g
(       << '\\n' << )66.36 634.9 ms
0 0.251 0 r
("element vertex ")s
0 g
( << num_cameras_ + num_points_)s
0.498 0.498 0 r
(   148)18.36 624.9 ms
0 g
(       << '\\n' << )66.36 624.9 ms
0 0.251 0 r
("property float x")s
0.498 0.498 0 r
(   149)18.36 614.9 ms
0 g
(       << '\\n' << )66.36 614.9 ms
0 0.251 0 r
("property float y")s
0.498 0.498 0 r
(   150)18.36 604.9 ms
0 g
(       << '\\n' << )66.36 604.9 ms
0 0.251 0 r
("property float z")s
0.498 0.498 0 r
(   151)18.36 594.9 ms
0 g
(       << '\\n' << )66.36 594.9 ms
0 0.251 0 r
("property uchar red")s
0.498 0.498 0 r
(   152)18.36 584.9 ms
0 g
(       << '\\n' << )66.36 584.9 ms
0 0.251 0 r
("property uchar green")s
0.498 0.498 0 r
(   153)18.36 574.9 ms
0 g
(       << '\\n' << )66.36 574.9 ms
0 0.251 0 r
("property uchar blue")s
0.498 0.498 0 r
(   154)18.36 564.9 ms
0 g
(       << '\\n' << )66.36 564.9 ms
0 0.251 0 r
("end_header")s
0 g
( << )s
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 g
(endl)s
0 g
(;)s
0.498 0.498 0 r
(   155)18.36 554.9 ms
(   156)18.36 544.9 ms
0 g
(    )66.36 544.9 ms
0 0.498 0.498 r
(// Export extrinsic data \(i.e. camera centers\) as green points.)s
0.498 0.498 0 r
(   157)18.36 534.9 ms
0 g
(    )66.36 534.9 ms
0.376 0 0 r
(double)s
0 g
( angle_axis[)s
0.498 0.125 0.498 r
(3)s
0 g
(];)s
0.498 0.498 0 r
(   158)18.36 524.9 ms
0 g
(    )66.36 524.9 ms
0.376 0 0 r
(double)s
0 g
( center[)s
0.498 0.125 0.498 r
(3)s
0 g
(];)s
0.498 0.498 0 r
(   159)18.36 514.9 ms
0 g
(    )66.36 514.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.376 g
(num_cameras)s
0 g
(\(\); ++i\) {)s
0.498 0.498 0 r
(   160)18.36 504.9 ms
0 g
(        )66.36 504.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *camera = )s
0.376 g
(cameras)s
0 g
(\(\) + )s
0.376 g
(camera_block_size)s
0 g
(\(\) * i;)s
0.498 0.498 0 r
(   161)18.36 494.9 ms
0 g
(        )66.36 494.9 ms
0.376 g
(CameraToAngelAxisAndCenter)s
0 g
(\(camera, angle_axis, center\);)s
0.498 0.498 0 r
(   162)18.36 484.9 ms
0 g
(        of << center[)66.36 484.9 ms
0.498 0.125 0.498 r
(0)s
0 g
(] << )s
0 0.251 0 r
(' ')s
0 g
( << center[)s
0.498 0.125 0.498 r
(1)s
0 g
(] << )s
0 0.251 0 r
(' ')s
0 g
( << center[)s
0.498 0.125 0.498 r
(2)s
0 g
(])s
0.498 0.498 0 r
(   163)18.36 474.9 ms
0 g
(           << )66.36 474.9 ms
0 0.251 0 r
("0 255 0")s
0 g
( << '\\n';)s
0.498 0.498 0 r
(   164)18.36 464.9 ms
0 g
(    })66.36 464.9 ms
0.498 0.498 0 r
(   165)18.36 454.9 ms
(   166)18.36 444.9 ms
0 g
(    )66.36 444.9 ms
0 0.498 0.498 r
(// Export the structure \(i.e. 3D Points\) as white points.)s
0.498 0.498 0 r
(   167)18.36 434.9 ms
0 g
(    )66.36 434.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *points = parameters_ + )s
0.376 g
(camera_block_size)s
0 g
(\(\) * num_cameras_;)s
0.498 0.498 0 r
(   168)18.36 424.9 ms
0 g
(    )66.36 424.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.376 g
(num_points)s
0 g
(\(\); ++i\) {)s
0.498 0.498 0 r
(   169)18.36 414.9 ms
0 g
(        )66.36 414.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *point = points + i * )s
0.376 g
(point_block_size)s
0 g
(\(\);)s
0.498 0.498 0 r
(   170)18.36 404.9 ms
0 g
(        )66.36 404.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(0)s
0 g
(; j < )s
0.376 g
(point_block_size)s
0 g
(\(\); ++j\) {)s
0.498 0.498 0 r
(   171)18.36 394.9 ms
0 g
(            of << point[j] << )66.36 394.9 ms
0 0.251 0 r
(' ')s
0 g
(;)s
0.498 0.498 0 r
(   172)18.36 384.9 ms
0 g
(        })66.36 384.9 ms
0.498 0.498 0 r
(   173)18.36 374.9 ms
0 g
(        of << )66.36 374.9 ms
0 0.251 0 r
("255 255 255)s
0 g
(\\n)s
0 0.251 0 r
(")s
0 g
(;)s
0.498 0.498 0 r
(   174)18.36 364.9 ms
0 g
(    })66.36 364.9 ms
0.498 0.498 0 r
(   175)18.36 354.9 ms
0 g
(    of.)66.36 354.9 ms
0.376 g
(close)s
0 g
(\(\);)s
0.498 0.498 0 r
(   176)18.36 344.9 ms
0 g
(})66.36 344.9 ms
0.498 0.498 0 r
(   177)18.36 334.9 ms
(   178)18.36 324.9 ms
0.376 0 0 r
(void)66.36 324.9 ms
0 g
( BALProblem::)s
0.376 g
(CameraToAngelAxisAndCenter)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *camera,)s
0.498 0.498 0 r
(   179)18.36 314.9 ms
0 g
(                                            )66.36 314.9 ms
0.376 0 0 r
(double)s
0 g
( *angle_axis,)s
0.498 0.498 0 r
(   180)18.36 304.9 ms
0 g
(                                            )66.36 304.9 ms
0.376 0 0 r
(double)s
0 g
( *center\) )s
0.376 0 0 r
(const)s
0 g
( {)s
0.498 0.498 0 r
(   181)18.36 294.9 ms
0 g
(    VectorRef )66.36 294.9 ms
0.376 g
(angle_axis_ref)s
0 g
(\(angle_axis, )s
0.498 0.125 0.498 r
(3)s
0 g
(\);)s
0.498 0.498 0 r
(   182)18.36 284.9 ms
0 g
(    )66.36 284.9 ms
0 0.498 0 r
(if)s
0 g
( \(use_quaternions_\) {)s
0.498 0.498 0 r
(   183)18.36 274.9 ms
0 g
(        )66.36 274.9 ms
0.376 g
(QuaternionToAngleAxis)s
0 g
(\(camera, angle_axis\);)s
0.498 0.498 0 r
(   184)18.36 264.9 ms
0 g
(    } )66.36 264.9 ms
0 0.498 0 r
(else)s
0 g
( {)s
0.498 0.498 0 r
(   185)18.36 254.9 ms
0 g
(        angle_axis_ref = )66.36 254.9 ms
0.376 g
(ConstVectorRef)s
0 g
(\(camera, )s
0.498 0.125 0.498 r
(3)s
0 g
(\);)s
0.498 0.498 0 r
(   186)18.36 244.9 ms
0 g
(    })66.36 244.9 ms
0.498 0.498 0 r
(   187)18.36 234.9 ms
(   188)18.36 224.9 ms
0 g
(    )66.36 224.9 ms
0 0.498 0.498 r
(// c = -R't)s
0.498 0.498 0 r
(   189)18.36 214.9 ms
0 g
(    Eigen::VectorXd inverse_rotation = -angle_axis_ref;)66.36 214.9 ms
0.498 0.498 0 r
(   190)18.36 204.9 ms
0 g
(    )66.36 204.9 ms
0.376 g
(AngleAxisRotatePoint)s
0 g
(\(inverse_rotation.)s
0.376 g
(data)s
0 g
(\(\),)s
0.498 0.498 0 r
(   191)18.36 194.9 ms
0 g
(                         camera + )66.36 194.9 ms
0.376 g
(camera_block_size)s
0 g
(\(\) - )s
0.498 0.125 0.498 r
(6)s
0 g
(,)s
0.498 0.498 0 r
(   192)18.36 184.9 ms
0 g
(                         center\);)66.36 184.9 ms
0.498 0.498 0 r
(   193)18.36 174.9 ms
0 g
(    )66.36 174.9 ms
0.376 g
(VectorRef)s
0 g
(\(center, )s
0.498 0.125 0.498 r
(3)s
0 g
(\) *= -)s
0.498 0.125 0.498 r
(1.0)s
0 g
(;)s
0.498 0.498 0 r
(   194)18.36 164.9 ms
0 g
(})66.36 164.9 ms
0.498 0.498 0 r
(   195)18.36 154.9 ms
(   196)18.36 144.9 ms
0.376 0 0 r
(void)66.36 144.9 ms
0 g
( BALProblem::)s
0.376 g
(AngleAxisAndCenterToCamera)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *angle_axis,)s
0.498 0.498 0 r
(   197)18.36 134.9 ms
0 g
(                                            )66.36 134.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( *center,)s
0.498 0.498 0 r
(   198)18.36 124.9 ms
0 g
(                                            )66.36 124.9 ms
0.376 0 0 r
(double)s
0 g
( *camera\) )s
0.376 0 0 r
(const)s
0 g
( {)s
0.498 0.498 0 r
(   199)18.36 114.9 ms
0 g
(    ConstVectorRef )66.36 114.9 ms
0.376 g
(angle_axis_ref)s
0 g
(\(angle_axis, )s
0.498 0.125 0.498 r
(3)s
0 g
(\);)s
0.498 0.498 0 r
(   200)18.36 104.9 ms
0 g
(    )66.36 104.9 ms
0 0.498 0 r
(if)s
0 g
( \(use_quaternions_\) {)s
0.498 0.498 0 r
(   201)18.36 94.9 ms
0 g
(        )66.36 94.9 ms
0.376 g
(AngleAxisToQuaternion)s
0 g
(\(angle_axis, camera\);)s
0.498 0.498 0 r
(   202)18.36 84.9 ms
0 g
(    } )66.36 84.9 ms
0 0.498 0 r
(else)s
0 g
( {)s
0.498 0.498 0 r
(   203)18.36 74.9 ms
0 g
(        )66.36 74.9 ms
0.376 g
(VectorRef)s
0 g
(\(camera, )s
0.498 0.125 0.498 r
(3)s
0 g
(\) = angle_axis_ref;)s
0.498 0.498 0 r
(   204)18.36 64.9 ms
0 g
(    })66.36 64.9 ms
0.498 0.498 0 r
(   205)18.36 54.9 ms
(   206)18.36 44.9 ms
0 g
(    )66.36 44.9 ms
0 0.498 0.498 r
(// t = -R * c)s
re sp
%%PageTrailer
%%Page: 4 4
%%BeginPageSetup
sv
0 g
F0 sf
%%EndPageSetup
F1 sf
(common.cpp                                                                             Page 4)18.36 744.9 ms
F0 sf
0.498 0.498 0 r
(   207)18.36 724.9 ms
0 g
(    )66.36 724.9 ms
0.376 g
(AngleAxisRotatePoint)s
0 g
(\(angle_axis, center, camera + )s
0.376 g
(camera_block_size)s
0 g
(\(\) - )s
0.498 0.125 0.498 r
(6)s
0 g
(\);)s
0.498 0.498 0 r
(   208)18.36 714.9 ms
0 g
(    )66.36 714.9 ms
0.376 g
(VectorRef)s
0 g
(\(camera + )s
0.376 g
(camera_block_size)s
0 g
(\(\) - )s
0.498 0.125 0.498 r
(6)s
0 g
(, )s
0.498 0.125 0.498 r
(3)s
0 g
(\) *= -)s
0.498 0.125 0.498 r
(1.0)s
0 g
(;)s
0.498 0.498 0 r
(   209)18.36 704.9 ms
0 g
(})66.36 704.9 ms
0.498 0.498 0 r
(   210)18.36 694.9 ms
(   211)18.36 684.9 ms
0.376 0 0 r
(void)66.36 684.9 ms
0 g
( BALProblem::)s
0.376 g
(Normalize)s
0 g
(\(\) {)s
0.498 0.498 0 r
(   212)18.36 674.9 ms
0 g
(    )66.36 674.9 ms
0 0.498 0.498 r
(// Compute the marginal median of the geometry)s
0.498 0.498 0 r
(   213)18.36 664.9 ms
0 g
(    )66.36 664.9 ms
0.251 0.251 0 r
(std)s
0 g
(::)s
0.376 0 0 r
(vector)s
0 g
(<)s
0.376 0 0 r
(double)s
0 g
(> )s
0.376 g
(tmp)s
0 g
(\(num_points_\);)s
0.498 0.498 0 r
(   214)18.36 654.9 ms
0 g
(    Eigen::Vector3d median;)66.36 654.9 ms
0.498 0.498 0 r
(   215)18.36 644.9 ms
0 g
(    )66.36 644.9 ms
0.376 0 0 r
(double)s
0 g
( *points = )s
0.376 g
(mutable_points)s
0 g
(\(\);)s
0.498 0.498 0 r
(   216)18.36 634.9 ms
0 g
(    )66.36 634.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < )s
0.498 0.125 0.498 r
(3)s
0 g
(; ++i\) {)s
0.498 0.498 0 r
(   217)18.36 624.9 ms
0 g
(        )66.36 624.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( j = )s
0.498 0.125 0.498 r
(0)s
0 g
(; j < num_points_; ++j\) {)s
0.498 0.498 0 r
(   218)18.36 614.9 ms
0 g
(            tmp[j] = points[)66.36 614.9 ms
0.498 0.125 0.498 r
(3)s
0 g
( * j + i];)s
0.498 0.498 0 r
(   219)18.36 604.9 ms
0 g
(        })66.36 604.9 ms
0.498 0.498 0 r
(   220)18.36 594.9 ms
0 g
(        )66.36 594.9 ms
0.376 g
(median)s
0 g
(\(i\) = )s
0.376 g
(Median)s
0 g
(\(&tmp\);)s
0.498 0.498 0 r
(   221)18.36 584.9 ms
0 g
(    })66.36 584.9 ms
0.498 0.498 0 r
(   222)18.36 574.9 ms
(   223)18.36 564.9 ms
0 g
(    )66.36 564.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_points_; ++i\) {)s
0.498 0.498 0 r
(   224)18.36 554.9 ms
0 g
(        VectorRef )66.36 554.9 ms
0.376 g
(point)s
0 g
(\(points + )s
0.498 0.125 0.498 r
(3)s
0 g
( * i, )s
0.498 0.125 0.498 r
(3)s
0 g
(\);)s
0.498 0.498 0 r
(   225)18.36 544.9 ms
0 g
(        tmp[i] = \(point - median\).lpNorm<)66.36 544.9 ms
0.498 0.125 0.498 r
(1)s
0 g
(>\(\);)s
0.498 0.498 0 r
(   226)18.36 534.9 ms
0 g
(    })66.36 534.9 ms
0.498 0.498 0 r
(   227)18.36 524.9 ms
(   228)18.36 514.9 ms
0 g
(    )66.36 514.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( median_absolute_deviation = )s
0.376 g
(Median)s
0 g
(\(&tmp\);)s
0.498 0.498 0 r
(   229)18.36 504.9 ms
(   230)18.36 494.9 ms
0 g
(    )66.36 494.9 ms
0 0.498 0.498 r
(// Scale so that the median absolute deviation of the resulting)s
0.498 0.498 0 r
(   231)18.36 484.9 ms
0 g
(    )66.36 484.9 ms
0 0.498 0.498 r
(// reconstruction is 100)s
0.498 0.498 0 r
(   232)18.36 474.9 ms
(   233)18.36 464.9 ms
0 g
(    )66.36 464.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( scale = )s
0.498 0.125 0.498 r
(100.0)s
0 g
( / median_absolute_deviation;)s
0.498 0.498 0 r
(   234)18.36 454.9 ms
(   235)18.36 444.9 ms
0 g
(    )66.36 444.9 ms
0 0.498 0.498 r
(// X = scale * \(X - median\))s
0.498 0.498 0 r
(   236)18.36 434.9 ms
0 g
(    )66.36 434.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_points_; ++i\) {)s
0.498 0.498 0 r
(   237)18.36 424.9 ms
0 g
(        VectorRef )66.36 424.9 ms
0.376 g
(point)s
0 g
(\(points + )s
0.498 0.125 0.498 r
(3)s
0 g
( * i, )s
0.498 0.125 0.498 r
(3)s
0 g
(\);)s
0.498 0.498 0 r
(   238)18.36 414.9 ms
0 g
(        point = scale * \(point - median\);)66.36 414.9 ms
0.498 0.498 0 r
(   239)18.36 404.9 ms
0 g
(    })66.36 404.9 ms
0.498 0.498 0 r
(   240)18.36 394.9 ms
(   241)18.36 384.9 ms
0 g
(    )66.36 384.9 ms
0.376 0 0 r
(double)s
0 g
( *cameras = )s
0.376 g
(mutable_cameras)s
0 g
(\(\);)s
0.498 0.498 0 r
(   242)18.36 374.9 ms
0 g
(    )66.36 374.9 ms
0.376 0 0 r
(double)s
0 g
( angle_axis[)s
0.498 0.125 0.498 r
(3)s
0 g
(];)s
0.498 0.498 0 r
(   243)18.36 364.9 ms
0 g
(    )66.36 364.9 ms
0.376 0 0 r
(double)s
0 g
( center[)s
0.498 0.125 0.498 r
(3)s
0 g
(];)s
0.498 0.498 0 r
(   244)18.36 354.9 ms
0 g
(    )66.36 354.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_cameras_; ++i\) {)s
0.498 0.498 0 r
(   245)18.36 344.9 ms
0 g
(        )66.36 344.9 ms
0.376 0 0 r
(double)s
0 g
( *camera = cameras + )s
0.376 g
(camera_block_size)s
0 g
(\(\) * i;)s
0.498 0.498 0 r
(   246)18.36 334.9 ms
0 g
(        )66.36 334.9 ms
0.376 g
(CameraToAngelAxisAndCenter)s
0 g
(\(camera, angle_axis, center\);)s
0.498 0.498 0 r
(   247)18.36 324.9 ms
0 g
(        )66.36 324.9 ms
0 0.498 0.498 r
(// center = scale * \(center - median\))s
0.498 0.498 0 r
(   248)18.36 314.9 ms
0 g
(        )66.36 314.9 ms
0.376 g
(VectorRef)s
0 g
(\(center, )s
0.498 0.125 0.498 r
(3)s
0 g
(\) = scale * \()s
0.376 g
(VectorRef)s
0 g
(\(center, )s
0.498 0.125 0.498 r
(3)s
0 g
(\) - median\);)s
0.498 0.498 0 r
(   249)18.36 304.9 ms
0 g
(        )66.36 304.9 ms
0.376 g
(AngleAxisAndCenterToCamera)s
0 g
(\(angle_axis, center, camera\);)s
0.498 0.498 0 r
(   250)18.36 294.9 ms
0 g
(    })66.36 294.9 ms
0.498 0.498 0 r
(   251)18.36 284.9 ms
0 g
(})66.36 284.9 ms
0.498 0.498 0 r
(   252)18.36 274.9 ms
(   253)18.36 264.9 ms
0.376 0 0 r
(void)66.36 264.9 ms
0 g
( BALProblem::)s
0.376 g
(Perturb)s
0 g
(\()s
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( rotation_sigma,)s
0.498 0.498 0 r
(   254)18.36 254.9 ms
0 g
(                         )66.36 254.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( translation_sigma,)s
0.498 0.498 0 r
(   255)18.36 244.9 ms
0 g
(                         )66.36 244.9 ms
0.376 0 0 r
(const)s
0 g
( )s
0.376 0 0 r
(double)s
0 g
( point_sigma\) {)s
0.498 0.498 0 r
(   256)18.36 234.9 ms
0 g
(    )66.36 234.9 ms
0.376 g
(assert)s
0 g
(\(point_sigma >= )s
0.498 0.125 0.498 r
(0.0)s
0 g
(\);)s
0.498 0.498 0 r
(   257)18.36 224.9 ms
0 g
(    )66.36 224.9 ms
0.376 g
(assert)s
0 g
(\(rotation_sigma >= )s
0.498 0.125 0.498 r
(0.0)s
0 g
(\);)s
0.498 0.498 0 r
(   258)18.36 214.9 ms
0 g
(    )66.36 214.9 ms
0.376 g
(assert)s
0 g
(\(translation_sigma >= )s
0.498 0.125 0.498 r
(0.0)s
0 g
(\);)s
0.498 0.498 0 r
(   259)18.36 204.9 ms
(   260)18.36 194.9 ms
0 g
(    )66.36 194.9 ms
0.376 0 0 r
(double)s
0 g
( *points = )s
0.376 g
(mutable_points)s
0 g
(\(\);)s
0.498 0.498 0 r
(   261)18.36 184.9 ms
0 g
(    )66.36 184.9 ms
0 0.498 0 r
(if)s
0 g
( \(point_sigma > )s
0.498 0.125 0.498 r
(0)s
0 g
(\) {)s
0.498 0.498 0 r
(   262)18.36 174.9 ms
0 g
(        )66.36 174.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_points_; ++i\) {)s
0.498 0.498 0 r
(   263)18.36 164.9 ms
0 g
(            )66.36 164.9 ms
0.376 g
(PerturbPoint3)s
0 g
(\(point_sigma, points + )s
0.498 0.125 0.498 r
(3)s
0 g
( * i\);)s
0.498 0.498 0 r
(   264)18.36 154.9 ms
0 g
(        })66.36 154.9 ms
0.498 0.498 0 r
(   265)18.36 144.9 ms
0 g
(    })66.36 144.9 ms
0.498 0.498 0 r
(   266)18.36 134.9 ms
(   267)18.36 124.9 ms
0 g
(    )66.36 124.9 ms
0 0.498 0 r
(for)s
0 g
( \()s
0.376 0 0 r
(int)s
0 g
( i = )s
0.498 0.125 0.498 r
(0)s
0 g
(; i < num_cameras_; ++i\) {)s
0.498 0.498 0 r
(   268)18.36 114.9 ms
0 g
(        )66.36 114.9 ms
0.376 0 0 r
(double)s
0 g
( *camera = )s
0.376 g
(mutable_cameras)s
0 g
(\(\) + )s
0.376 g
(camera_block_size)s
0 g
(\(\) * i;)s
0.498 0.498 0 r
(   269)18.36 104.9 ms
(   270)18.36 94.9 ms
0 g
(        )66.36 94.9 ms
0.376 0 0 r
(double)s
0 g
( angle_axis[)s
0.498 0.125 0.498 r
(3)s
0 g
(];)s
0.498 0.498 0 r
(   271)18.36 84.9 ms
0 g
(        )66.36 84.9 ms
0.376 0 0 r
(double)s
0 g
( center[)s
0.498 0.125 0.498 r
(3)s
0 g
(];)s
0.498 0.498 0 r
(   272)18.36 74.9 ms
0 g
(        )66.36 74.9 ms
0 0.498 0.498 r
(// Perturb in the rotation of the camera in the angle-axis)s
0.498 0.498 0 r
(   273)18.36 64.9 ms
0 g
(        )66.36 64.9 ms
0 0.498 0.498 r
(// representation)s
0.498 0.498 0 r
(   274)18.36 54.9 ms
0 g
(        )66.36 54.9 ms
0.376 g
(CameraToAngelAxisAndCenter)s
0 g
(\(camera, angle_axis, center\);)s
0.498 0.498 0 r
(   275)18.36 44.9 ms
0 g
(        )66.36 44.9 ms
0 0.498 0 r
(if)s
0 g
( \(rotation_sigma > )s
0.498 0.125 0.498 r
(0.0)s
0 g
(\) {)s
re sp
%%PageTrailer
%%Page: 5 5
%%BeginPageSetup
sv
0 g
F0 sf
%%EndPageSetup
F1 sf
(common.cpp                                                                             Page 5)18.36 744.9 ms
F0 sf
0.498 0.498 0 r
(   276)18.36 724.9 ms
0 g
(            )66.36 724.9 ms
0.376 g
(PerturbPoint3)s
0 g
(\(rotation_sigma, angle_axis\);)s
0.498 0.498 0 r
(   277)18.36 714.9 ms
0 g
(        })66.36 714.9 ms
0.498 0.498 0 r
(   278)18.36 704.9 ms
0 g
(        )66.36 704.9 ms
0.376 g
(AngleAxisAndCenterToCamera)s
0 g
(\(angle_axis, center, camera\);)s
0.498 0.498 0 r
(   279)18.36 694.9 ms
(   280)18.36 684.9 ms
0 g
(        )66.36 684.9 ms
0 0.498 0 r
(if)s
0 g
( \(translation_sigma > )s
0.498 0.125 0.498 r
(0.0)s
0 g
(\))s
0.498 0.498 0 r
(   281)18.36 674.9 ms
0 g
(            )66.36 674.9 ms
0.376 g
(PerturbPoint3)s
0 g
(\(translation_sigma, camera + )s
0.376 g
(camera_block_size)s
0 g
(\(\) - )s
0.498 0.125 0.498 r
(6)s
0 g
(\);)s
0.498 0.498 0 r
(   282)18.36 664.9 ms
0 g
(    })66.36 664.9 ms
0.498 0.498 0 r
(   283)18.36 654.9 ms
0 g
(})66.36 654.9 ms
re sp
%%PageTrailer
%%Trailer
%%Pages: 5
%%EOF
